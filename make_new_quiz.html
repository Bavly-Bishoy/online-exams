<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù…ØªØ­Ø§Ù† Ø¬Ø¯ÙŠØ¯</title>
<style>
body{font-family:"Cairo",sans-serif;margin:0;padding:0;background:#f5f7fa;color:#0d47a1;transition:all .3s}
body.dark{background:#0f1724;color:#f8fafc}
header{background:#0d47a1;color:white;text-align:center;padding:20px;font-size:1.5rem;font-weight:bold;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
.container{max-width:900px;margin:30px auto;padding:25px;background:white;border-radius:15px;box-shadow:0 4px 20px rgba(0,0,0,0.1)}
.container.dark{background:#111827}
label{font-weight:bold;display:block;margin-top:15px;margin-bottom:5px}
input, select, textarea, button{width:100%;padding:10px;margin-bottom:10px;border-radius:10px;font-size:1rem;box-sizing:border-box}
input, select, textarea{border:1px solid #90caf9}
button{background:#0d47a1;color:white;cursor:pointer;font-weight:bold;transition:.3s;border:none}
button:hover{background:#1565c0}
.question{background:#e3f2fd;padding:15px;border-radius:10px;margin-top:10px}
.question.dark{background:#1f2937}
.choice{display:flex;gap:10px;margin-bottom:5px;align-items:center}
.link-box{background:#f0f7ff;border:1px dashed #90caf9;padding:10px;border-radius:10px;text-align:center;margin-top:15px}
</style>
</head>
<body>
<header>ğŸ“˜ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù…ØªØ­Ø§Ù† Ø¬Ø¯ÙŠØ¯</header>
<div class="container" id="container">
<label>Ø§Ø³Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</label>
<input type="text" id="examName" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©">
<label>Ù„ØºØ© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</label>
<select id="examLang">
<option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
<option value="en">English</option>
</select>
<label>Ù…Ø¯Ø© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† (Ø¯Ù‚Ø§Ø¦Ù‚):</label>
<input type="number" id="examTime" min="1" placeholder="Ù…Ø«Ù„Ø§Ù‹: 30">
<label>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø«ÙŠÙ…:</label>
<select id="themeSelect">
<option value="light">ÙØ§ØªØ­</option>
<option value="dark">ØºØ§Ù…Ù‚</option>
</select>
<h3>Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:</h3>
<div id="questions"></div>
<div class="controls">
<button onclick="addQuestion()">â• Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„</button>
<button onclick="generateExam()">ğŸ’¾ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
</div>
<div id="result" class="link-box" style="display:none"></div>
</div>
<script>
let questions=[];
const container=document.getElementById('container');
const themeSelect=document.getElementById('themeSelect');
themeSelect.addEventListener('change',()=>applyTheme(themeSelect.value));
function applyTheme(t){if(t==='dark'){document.body.classList.add('dark'); container.classList.add('dark');}else{document.body.classList.remove('dark'); container.classList.remove('dark');}}
function addQuestion(){
  const qDiv=document.createElement('div'); qDiv.className='question';
  qDiv.innerHTML=`
<label>Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
<textarea class="qText" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§"></textarea>
<label>Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
<select class="qType" onchange="toggleAnswerInput(this)">
<option value="text">Ù…Ù‚Ø§Ù„ÙŠ</option>
<option value="truefalse">ØµØ­ / Ø®Ø·Ø£</option>
<option value="mcq">Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯</option>
</select>
<div class="answerBox"></div>`;
  document.getElementById('questions').appendChild(qDiv);
}
function toggleAnswerInput(s){
  const box=s.parentElement.querySelector('.answerBox');
  if(s.value==='truefalse'){box.innerHTML=`<label>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</label><select class="qAnswer"><option value="true">ØµØ­</option><option value="false">Ø®Ø·Ø£</option></select>`}
  else if(s.value==='mcq'){box.innerHTML=`
<div class="choice"><input type="radio" name="opt${Date.now()}" value="1"><input type="text" placeholder="Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± 1"></div>
<div class="choice"><input type="radio" name="opt${Date.now()}" value="2"><input type="text" placeholder="Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± 2"></div>
<div class="choice"><input type="radio" name="opt${Date.now()}" value="3"><input type="text" placeholder="Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± 3"></div>
<div class="choice"><input type="radio" name="opt${Date.now()}" value="4"><input type="text" placeholder="Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± 4"></div>`}
  else{box.innerHTML=`<label>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</label><input type="text" class="qAnswer">`}
}
function generateExam(){
  const name=document.getElementById('examName').value.trim();
  const lang=document.getElementById('examLang').value;
  const time=document.getElementById('examTime').value;
  if(!name||!time)return alert('Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©');
  const qDivs=document.querySelectorAll('.question'); questions=[];
  qDivs.forEach(div=>{
    const text=div.querySelector('.qText').value.trim();
    const type=div.querySelector('.qType').value;
    let answer='',choices=[];
    if(type==='truefalse'){answer=div.querySelector('.qAnswer').value}
    else if(type==='mcq'){const opts=div.querySelectorAll('.choice');opts.forEach(opt=>{choices.push(opt.querySelector('input[type="text"]').value); if(opt.querySelector('input[type="radio"]').checked) answer=opt.querySelector('input[type="text"]').value;})}
    else{answer=div.querySelector('.qAnswer')?.value.trim()||''}
    if(text)questions.push({text,type,answer,choices});
  });
  if(questions.length===0)return alert('Ø£Ø¶Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø³Ø¤Ø§Ù„ ÙˆØ§Ø­Ø¯');
  const examData={examName:'Ø§Ù…ØªØ­Ø§Ù† '+name,language:lang,time,questions};
  const fileName='exam_'+Date.now()+'.json';
  // Ø­ÙØ¸ ÙÙŠ LocalStorage ÙƒÙ‚Ø§Ø¦Ù…Ø©
  let allExams=JSON.parse(localStorage.getItem('all_exams')||'[]');
  allExams.push({name:'Ø§Ù…ØªØ­Ø§Ù† '+name,file:fileName,data:examData});
  localStorage.setItem('all_exams',JSON.stringify(allExams));
  // Ø­ÙØ¸ Ù…Ù„Ù JSON (ØªÙ†Ø²ÙŠÙ„)
  const dataStr="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(examData,null,2));
  const dlAnchor=document.createElement('a'); dlAnchor.setAttribute('href',dataStr); dlAnchor.setAttribute('download',fileName); dlAnchor.click();
  const resultBox=document.getElementById('result'); resultBox.style.display='block';
  resultBox.innerHTML=`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­!<br><b>Ø±Ø§Ø¨Ø· Ø§Ù„Ø·Ù„Ø§Ø¨:</b><br>
<a href="student.html?exam=${encodeURIComponent(fileName)}" target="_blank">ÙØªØ­ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ù„Ù„Ø·Ù„Ø§Ø¨</a>`;
}
</script>
</body>
</html>
